const guestList = {
    "6910827657f7987e6464de267d0849ec": {
        "plusOneAllowed": true
    },
    "32b6146d47892271b4b060c095757d65": {
        "plusOneAllowed": true
    },
    "18391dbef91048cae047388804cf2be6": {
        "plusOneAllowed": true
    },
    "856eaf13a1ea2e137c6e74569e31506d": {
        "plusOneAllowed": true
    },
    "5388c0a05d1ded354d11b0eefd456161": {
        "plusOneAllowed": true
    },
    "01d315ad50f2b191b9a1943866c14c8d": {
        "plusOneAllowed": true
    },
    "37d54dc9b642968f824d5b0ce39223f6": {
        "plusOneAllowed": true
    },
    "38041de5a248ff21b72a90f7817d901a": {
        "plusOneAllowed": true
    },
    "e886f58c5ce426c22a63d5aef61de516": {
        "plusOneAllowed": true
    },
    "42ee842e8214e415ab5d1807b800d0a2": {
        "plusOneAllowed": true
    },
    "60b392787d74b53d45a3bc5a2b4e7cc4": {
        "plusOneAllowed": false
    },
    "ea4dc9995e2b34434c0a01d4d07ddbaa": {
        "plusOneAllowed": true
    },
    "6e90979042ceda315079c252826a71e5": {
        "plusOneAllowed": true
    },
    "7258c82d1e6b1455e23868613a4e40e4": {
        "plusOneAllowed": true
    },
    "adc2da49715ba2efd5529895c5855763": {
        "plusOneAllowed": true
    },
    "662b97e162e49654306b4e0b516e3eba": {
        "plusOneAllowed": false
    },
    "f23d03da18a66e40722f03a441273a2e": {
        "plusOneAllowed": true
    },
    "c191d344c4f39932e5e917a0ec738a37": {
        "plusOneAllowed": true
    },
    "7f02607205e95c511fc0a65e06d6971a": {
        "plusOneAllowed": true
    },
    "3a074909e943412f0e356bf55464a2ec": {
        "plusOneAllowed": true
    },
    "196d3798930340f14f3db819a60e4dee": {
        "plusOneAllowed": true
    },
    "8fbfcfda4ad11e84e8d6a4a8a391ad68": {
        "plusOneAllowed": true
    },
    "4a971ed25848efccce3662d6a6983faa": {
        "plusOneAllowed": true
    },
    "7af81d30502f61f98b1fdfa3fecc0fc5": {
        "plusOneAllowed": true
    },
    "c8c230c98ca80f49e23d7decabc1fedb": {
        "plusOneAllowed": true
    },
    "6d9865eb249863a5f9348af9b4de0b8a": {
        "plusOneAllowed": true
    },
    "94edbb68c8d4722f5d3f8c78e7fc18b6": {
        "plusOneAllowed": false
    },
    "4ef6aab14d5ad8f0353862d8eadcfa02": {
        "plusOneAllowed": true
    },
    "5db388b64d06c55450273323e2aa77be": {
        "plusOneAllowed": true
    },
    "f5254c9521bc4ca437c162538db1c047": {
        "plusOneAllowed": false
    },
    "5607c02629ae3fb6577b89f8dce7373d": {
        "plusOneAllowed": true
    },
    "6b3dbad99021ee09d3671128d251bf30": {
        "plusOneAllowed": true
    },
    "bd5e2f1f402d7cd3aef398ddda15dc80": {
        "plusOneAllowed": false
    },
    "f5037eedf94aada180dcb86d02a0f572": {
        "plusOneAllowed": false
    },
    "524a53a21a4e5f518eb81d2d44dc733c": {
        "plusOneAllowed": true
    },
    "812974f3c34e95c549b0ff8b810855c2": {
        "plusOneAllowed": true
    },
    "02406efbe4e319c01596c3844582d642": {
        "plusOneAllowed": true
    },
    "9c33ff36cd4d640ffc51e547990cb49d": {
        "plusOneAllowed": true
    },
    "85557695e1adb33631d8572fea590f33": {
        "plusOneAllowed": true
    },
    "28ed6e98b3771896133c2bf416208826": {
        "plusOneAllowed": true
    },
    "dea35a7f01cfde5c69bf91b9b4954f2c": {
        "plusOneAllowed": true
    },
    "13b1f603f9ce78c952cd3c39ba2bf4c1": {
        "plusOneAllowed": true
    },
    "121fbaca2922d978859dfa21936ad073": {
        "plusOneAllowed": false
    },
    "15240c41a00117897fce3af753d7aa34": {
        "plusOneAllowed": true
    },
    "ffd3666a1473af65f13fcc442b6828d2": {
        "plusOneAllowed": true
    },
    "3f30483e61965ced00f06a114d9b421b": {
        "plusOneAllowed": true
    },
    "b0a8edf453202051196ff7ff8ab26381": {
        "plusOneAllowed": true
    },
    "fde9abb4b3152a60d8ea3fb0870c4d6c": {
        "plusOneAllowed": true
    },
    "50ba1291604afd26e03b7ccfcc9e9799": {
        "plusOneAllowed": true
    },
    "4009b186a018b398f8724c28edd8e697": {
        "plusOneAllowed": true
    },
    "423ba11c0fe77712bb85351deefa02f4": {
        "plusOneAllowed": true
    },
    "282b4c46c4812e4c0cc8ff07c41bb315": {
        "plusOneAllowed": true
    },
    "dcad60622f55ae0ab87d3bf42ececb53": {
        "plusOneAllowed": true
    },
    "a463a1934608411a5e4d418e6b7fa431": {
        "plusOneAllowed": true
    },
    "0ab9cb39e8a648da5124843abd3e9c17": {
        "plusOneAllowed": true
    },
    "f4d58b36b73c7c04cef5b1fdb2896695": {
        "plusOneAllowed": true
    },
    "afc2ffd7dbf75e442105f0ad27758ea3": {
        "plusOneAllowed": true
    },
    "5ab69af936d16b75fda95d2a97a60fa7": {
        "plusOneAllowed": true
    },
    "2a60d413fff734f82e89215d2d13b04c": {
        "plusOneAllowed": true
    },
    "b7aaf8c6ab01c3f50059852ec76c9365": {
        "plusOneAllowed": false
    },
    "5e0c76d099608b077bf93b9705eff982": {
        "plusOneAllowed": true
    },
    "1673dc322a539ad48160bb212acb2a8c": {
        "plusOneAllowed": true
    },
    "b4f3f38474f5d5ee72700b573c7ee252": {
        "plusOneAllowed": false
    },
    "d539ec182244527a0785bfedd1a76935": {
        "plusOneAllowed": false
    },
    "1fc78cb74ab4a38f40928f047e3a3dfb": {
        "plusOneAllowed": true
    },
    "d6f381eba07940642b2a2308982c4a3e": {
        "plusOneAllowed": true
    },
    "538be4126a1b1690e1b28149a4f8f6db": {
        "plusOneAllowed": true
    },
    "cd02089ac0fa5caa7be401c1d0bb2b7c": {
        "plusOneAllowed": true
    },
    "d85af1c7308956285c840d5ba149a66c": {
        "plusOneAllowed": false
    },
    "f9836f02f35d8b17c7cb28594c57b572": {
        "plusOneAllowed": true
    },
    "ad2a215a11317c6a18282ee6c9bfc80a": {
        "plusOneAllowed": true
    },
    "f62b7c6ef6e0ba2ca8eaae85a4ab8550": {
        "plusOneAllowed": true
    },
    "65c92f5e74814779416b90051bdc260e": {
        "plusOneAllowed": true
    },
    "2a240777233c3647a86239a315f2a4ef": {
        "plusOneAllowed": true
    },
    "144365b084ee4eb2b5f7ecdc90b90040": {
        "plusOneAllowed": true
    },
    "064eceeccf5f5956f4c32853e70b12ec": {
        "plusOneAllowed": false
    },
    "17ba8ac48ca2ca922d38b19ebe337eba": {
        "plusOneAllowed": false
    },
    "7aa92fdc6655d46b5673c7ff2b52fa1d": {
        "plusOneAllowed": true
    },
    "032947fd25da640fad6d8c09ad2256a1": {
        "plusOneAllowed": true
    },
    "84ba0fe212363a8423a355900c301c64": {
        "plusOneAllowed": false
    },
    "ba37ec688680b49539b36915380caf88": {
        "plusOneAllowed": true
    },
    "350d89c1cd6592bbbd1ed2e8a4f3ddba": {
        "plusOneAllowed": true
    },
    "02392a2659bde8ac2a7a67e2b6982d90": {
        "plusOneAllowed": true
    },
    "53dd9c6005f3cdfc5a69c5c07388016d": {
        "plusOneAllowed": true
    },
    "aaf8165feadc4735cc92578511cff1c0": {
        "plusOneAllowed": false
    },
    "b3fb7ef1c3fb33f84d348d38a21a2833": {
        "plusOneAllowed": false
    },
    "a68990964fce621e6e684a706f2450ef": {
        "plusOneAllowed": true
    },
    "7b3b48eb940ad0aa3977e83f4009aa6b": {
        "plusOneAllowed": true
    },
    "665df8ba8fed0f6b5cfbb3536e609844": {
        "plusOneAllowed": true
    },
    "0f51204dad256b989b88f6791d1f7e12": {
        "plusOneAllowed": true
    },
    "c5ffabd145b8ebaeaaebfbb4ad901a90": {
        "plusOneAllowed": true
    },
    "7a41f726b70367f7aff8f08cd85119b0": {
        "plusOneAllowed": true
    },
    "8c58c12010478b53c3b9d5573270e7de": {
        "plusOneAllowed": true
    },
    "5f09e203c2ab8458c1de3b80089a7431": {
        "plusOneAllowed": true
    },
    "54c81fd5c2587c27db55d1e59695f898": {
        "plusOneAllowed": false
    },
    "32a9a6470d61e6d8bc737e82b9d71255": {
        "plusOneAllowed": true
    },
    "b498d5e73b3a86be9004051b1c4cac11": {
        "plusOneAllowed": true
    },
    "0302b768d32b8f7659b7c5447b7b1b03": {
        "plusOneAllowed": true
    },
    "f710ebd1420ea67687f411fc5de2dad3": {
        "plusOneAllowed": true
    },
    "16d5c32514e6163b1032d651d6dc8f81": {
        "plusOneAllowed": false
    },
    "9e346d746f3f4f4af0df25c4cf762e9b": {
        "plusOneAllowed": true
    },
    "fd7c4a8f7e97cc73cc35ea23172de8d7": {
        "plusOneAllowed": true
    },
    "f6fd7b3dfe595e9b700c46a4af08efd8": {
        "plusOneAllowed": true
    },
    "16e4ef3b1b8115ce7ce3f3e395b45730": {
        "plusOneAllowed": true
    },
    "0b32e2f9ca46763ef2c936b8222a2ad5": {
        "plusOneAllowed": true
    },
    "73b11a213a627fb6be2d4b598190b090": {
        "plusOneAllowed": true
    },
    "c629414443a37e432c3a2f60cfa966ef": {
        "plusOneAllowed": true
    },
    "959e2c51adf2eb0b6b58aa330542237c": {
        "plusOneAllowed": true
    },
    "7bc158b3a5bc251c742f49c9a8829813": {
        "plusOneAllowed": false
    },
    "8ba913ad97a2aa440b6ef8d2ba5f997e": {
        "plusOneAllowed": false
    },
    "53313abd470829cc812af63d15c90007": {
        "plusOneAllowed": true
    },
    "d43361acaeec0c476b0e0b9000da4e99": {
        "plusOneAllowed": true
    },
    "19aa32e72915e328036e8c73f537fbdb": {
        "plusOneAllowed": true
    },
    "6e51b97a9fc69e8eaec6a6f8a1858b75": {
        "plusOneAllowed": true
    },
    "59e149ae04eb66dfd6490f5829ae42da": {
        "plusOneAllowed": false
    },
    "4f6cc5d9ed7716e647eae660d05af10b": {
        "plusOneAllowed": true
    },
    "ff02bcba2c3f49e7f8c61c2614611a12": {
        "plusOneAllowed": true
    },
    "9e6831366ef104cacef8fd1cbca9b94b": {
        "plusOneAllowed": false
    },
    "930cb90a29b652b4a13d3530acbf199f": {
        "plusOneAllowed": true
    },
    "5069e2d7019d9ee80626123d762f152f": {
        "plusOneAllowed": true
    },
    "5f99354e1cff81aafe7fbbc5607eb276": {
        "plusOneAllowed": true
    },
    "bb2e4c1498162eb6743f1728e8e403fe": {
        "plusOneAllowed": true
    },
    "363326490aca15d36d15bff5cec6f710": {
        "plusOneAllowed": true
    },
    "9671f55d89c8cfb753e205c9fd28a897": {
        "plusOneAllowed": true
    },
    "caca94aa016dedb2c5fec9c3bc59e1bf": {
        "plusOneAllowed": false
    },
    "353c8cb6495e120b717c3bb25cf898fa": {
        "plusOneAllowed": true
    },
    "bb7465ba87be0efe865743edf8bdebd9": {
        "plusOneAllowed": true
    },
    "573553290bfb4d357673d0d73767bbdf": {
        "plusOneAllowed": false
    },
    "0c2c4d3ae5d8d7894e9fe5bd452fb64a": {
        "plusOneAllowed": true
    },
    "8805375efdd99de6a76143de2058b142": {
        "plusOneAllowed": true
    },
    "6472c149f02c14f71e5c44ba8d0f479c": {
        "plusOneAllowed": false
    },
    "36979fd8bdb329b8645a7317357c1e2d": {
        "plusOneAllowed": true
    },
    "202230732ea2f1b173bb8f70009b8fba": {
        "plusOneAllowed": true
    },
    "08b191b6ac120bf63d28adb0d7bc3031": {
        "plusOneAllowed": true
    },
    "bcc63318d5670a5387e0d96a86a7fcc6": {
        "plusOneAllowed": true
    },
    "0b1981586449b4eccda3210d86cde031": {
        "plusOneAllowed": false
    },
    "41692da2bf6176685c6914b23da9a0f1": {
        "plusOneAllowed": true
    },
    "afb2c37ef258a37983a8283a1b09c300": {
        "plusOneAllowed": true
    },
    "cc678c6c34844e90f13daaf5da73be87": {
        "plusOneAllowed": true
    },
    "662aaff11251e3244b13d5bf3f36b9ec": {
        "plusOneAllowed": true
    },
    "631095dd51701865de0ef3490e644bb5": {
        "plusOneAllowed": true
    },
    "5cb91dbf959fe6484b54a0859fc6fc39": {
        "plusOneAllowed": true
    },
    "473c15334a19bbd404de9c09392f50ec": {
        "plusOneAllowed": false
    },
    "94b86dcb90b1ababfd84d65842a1f97e": {
        "plusOneAllowed": true
    },
    "8c4205ec33d8f6caeaaaa0c10a14138c": {
        "plusOneAllowed": true
    },
    "0c8cf033fd7f1d784b995b5d32a6759c": {
        "plusOneAllowed": true
    },
    "85ae107153f98d83085aadf36e10b733": {
        "plusOneAllowed": true
    },
    "39741690bee1b335bfb3e53b6a2ccc44": {
        "plusOneAllowed": true
    },
    "a7b6a639573785b27babc75bec19f073": {
        "plusOneAllowed": true
    },
    "edc8541efcf52ecb677dec5a2684d44c": {
        "plusOneAllowed": false
    },
    "0f42f925c1b805195765cdb3e10b06fd": {
        "plusOneAllowed": false
    },
    "bb5a0738309ec7b1e592781b9719d3f3": {
        "plusOneAllowed": true
    },
    "e8f9086d07ac2c38e0f502e9757f1c92": {
        "plusOneAllowed": true
    },
    "d100fbf545a79b4128730ab8ffe8daf8": {
        "plusOneAllowed": true
    },
    "3a23bb515e06d0e944ff916e79a7775c": {
        "plusOneAllowed": true
    },
    "9dec3414ca86df055aea18c13be69520": {
        "plusOneAllowed": true
    },
    "485b6e128238707b4ed7f5b9d951cf0c": {
        "plusOneAllowed": true
    },
    "a79f6b342066bf5fbbe0b06437141191": {
        "plusOneAllowed": true
    },
    "b1d7798cac2fcb7bf0a7f2cab8ee15f1": {
        "plusOneAllowed": true
    },
    "cced529e0c2d6a00a46e48d051d4a5f0": {
        "plusOneAllowed": false
    },
    "5f2a78c0a693ece4f4d6969a81dfc4f0": {
        "plusOneAllowed": true
    },
    "2b9ff3efc4a999ecfacd18c4bbc57a2e": {
        "plusOneAllowed": true
    },
    "cdaed5326a69e72dfc1c0e8f0b058f5b": {
        "plusOneAllowed": false
    },
    "ff833243bba9f06a1c20f52c6bdbd4f9": {
        "plusOneAllowed": true
    },
    "e928449737dca5a5ad427d4c0d8483ee": {
        "plusOneAllowed": true
    },
    "8fc066a1a04275601c0564e782fb06a6": {
        "plusOneAllowed": true
    },
    "a2d4100de5a4c446ab1f52b1bf20cd93": {
        "plusOneAllowed": true
    },
    "f384f637e6af55c698426d0daab107ec": {
        "plusOneAllowed": true
    },
    "8068612921a3ea3a173dfb57dd2e5f1d": {
        "plusOneAllowed": true
    },
    "e24625d5be51de7c148ec7088a4f8752": {
        "plusOneAllowed": true
    },
    "52c64af63a4feb53ae72ea94c88efa7a": {
        "plusOneAllowed": true
    },
    "09812f5b055a4c118a37c8b81c967e47": {
        "plusOneAllowed": false
    },
    "aa00dd20e0ab03db4a183a15517aac85": {
        "plusOneAllowed": true
    },
    "2f3d1a13947fdca331ce7822a2be22ec": {
        "plusOneAllowed": true
    },
    "ebfb4a680fbff6285993d84f1d5975d0": {
        "plusOneAllowed": true
    },
    "72a779cc02b7a2e649c4f0e42f19d4cc": {
        "plusOneAllowed": true
    },
    "4e9548c5f4e18924011338e08e1b79f1": {
        "plusOneAllowed": true
    },
    "237105bdb98dd7c26572ac80eb3260d4": {
        "plusOneAllowed": true
    },
    "d5fd7c45ade5539604c6641d2fa9eddc": {
        "plusOneAllowed": false
    },
    "0ae7424d92ac01d8bc6db8e5e13b3a93": {
        "plusOneAllowed": true
    }
};
$(document).ready(function () {
  /***************** Waypoints ******************/

  $('.wp1').waypoint(
    function () {
      $('.wp1').addClass('animated fadeInLeft');
    },
    {
      offset: '75%',
    }
  );
  $('.wp2').waypoint(
    function () {
      $('.wp2').addClass('animated fadeInRight');
    },
    {
      offset: '75%',
    }
  );
  $('.wp3').waypoint(
    function () {
      $('.wp3').addClass('animated fadeInLeft');
    },
    {
      offset: '75%',
    }
  );
  $('.wp4').waypoint(
    function () {
      $('.wp4').addClass('animated fadeInRight');
    },
    {
      offset: '75%',
    }
  );
  $('.wp5').waypoint(
    function () {
      $('.wp5').addClass('animated fadeInLeft');
    },
    {
      offset: '75%',
    }
  );
  $('.wp6').waypoint(
    function () {
      $('.wp6').addClass('animated fadeInRight');
    },
    {
      offset: '75%',
    }
  );
  $('.wp7').waypoint(
    function () {
      $('.wp7').addClass('animated fadeInUp');
    },
    {
      offset: '75%',
    }
  );
  $('.wp8').waypoint(
    function () {
      $('.wp8').addClass('animated fadeInLeft');
    },
    {
      offset: '75%',
    }
  );
  $('.wp9').waypoint(
    function () {
      $('.wp9').addClass('animated fadeInRight');
    },
    {
      offset: '75%',
    }
  );

  /***************** Initiate Flexslider ******************/
  $('.flexslider').flexslider({
    animation: 'slide',
  });

  /***************** Initiate Fancybox ******************/

  $('.single_image').fancybox({
    padding: 4,
  });

  $('.fancybox').fancybox({
    padding: 4,
    width: 1000,
    height: 800,
  });

  /***************** Tooltips ******************/
  $('[data-toggle="tooltip"]').tooltip();

  /***************** Melo Popup ******************/
  document.getElementById('heart-icon').addEventListener('click', function () {
    document.getElementById('melo-popup').style.display = 'block';
  });

  document
    .querySelector('.melo-popup .close')
    .addEventListener('click', function () {
      document.getElementById('melo-popup').style.display = 'none';
    });

  // Close the popup if the user clicks outside the content
  window.addEventListener('click', function (event) {
    var popup = document.getElementById('melo-popup');
    if (event.target == popup) {
      popup.style.display = 'none';
    }
  });

  /***************** Nav Transformicon ******************/

  /* When user clicks the Icon */
  $('.nav-toggle').click(function () {
    $(this).toggleClass('active');
    $('.header-nav').toggleClass('open');
    event.preventDefault();
  });
  /* When user clicks a link */
  $('.header-nav li a').click(function () {
    $('.nav-toggle').toggleClass('active');
    $('.header-nav').toggleClass('open');
  });

  /***************** Header BG Scroll ******************/

  $(function () {
    $(window).scroll(function () {
      var scroll = $(window).scrollTop();

      if (scroll >= 20) {
        $('section.navigation').addClass('fixed');
        $('header').css({
          'border-bottom': 'none',
          padding: '35px 0',
        });
        $('header .member-actions').css({
          top: '26px',
        });
        $('header .navicon').css({
          top: '34px',
        });
      } else {
        $('section.navigation').removeClass('fixed');
        $('header').css({
          'border-bottom': 'solid 1px rgba(255, 255, 255, 0.2)',
          padding: '50px 0',
        });
        $('header .member-actions').css({
          top: '41px',
        });
        $('header .navicon').css({
          top: '48px',
        });
      }
    });
  });
  /***************** Smooth Scrolling ******************/

  $(function () {
    $('a[href*=#]:not([href=#])').click(function () {
      if (
        location.pathname.replace(/^\//, '') ===
          this.pathname.replace(/^\//, '') &&
        location.hostname === this.hostname
      ) {
        var target = $(this.hash);
        target = target.length
          ? target
          : $('[name=' + this.hash.slice(1) + ']');
        if (target.length) {
          $('html,body').animate(
            {
              scrollTop: target.offset().top - 90,
            },
            2000
          );
          return false;
        }
      }
    });
  });

  /********************** Embed youtube video *********************/
  $('.player').YTPlayer();

  /********************** Snake game *********************/
  const canvas = document.getElementById('snakeGame');
  const ctx = canvas.getContext('2d');
  const box = 30;
  const secretCode = 'This is the secret code.'; // The secret code that gets revealed
  let currentLetterIndex = 0;
  let secretCodeDisplay = document.getElementById('secret-code-display');
  let startButton = document.getElementById('startButton');
  let gameOverPopup = document.getElementById('gameOverPopup');
  let closeButton = document.querySelector('.melo-popup .close');
  let restartButton = document.getElementById('restartButton');
  let game; // Will store the game interval

  // Mobile control buttons
  let leftBtn = document.getElementById('leftBtn');
  let rightBtn = document.getElementById('rightBtn');
  let upBtn = document.getElementById('upBtn');
  let downBtn = document.getElementById('downBtn');

  let snake = [{ x: 10 * box, y: 10 * box }];
  let direction = 'RIGHT';
  let apple = {
    x: Math.floor(Math.random() * 20) * box,
    y: Math.floor(Math.random() * 20) * box,
  };

  document.addEventListener('keydown', changeDirection);

  // Start the game when the button is clicked
  startButton.addEventListener('click', function () {
    resetGame();
    game = setInterval(updateGame, 200); // Slower game loop (200ms)
    startButton.disabled = true; // Disable the button while the game is running
    gameOverPopup.style.display = 'none'; // Hide popup if it was previously shown
  });

  // Close the popup when the "x" button is clicked
  closeButton.addEventListener('click', function () {
    gameOverPopup.style.display = 'none';
    startButton.disabled = false; // Re-enable start button
  });

  // Restart the game when the "Restart Game" button is clicked
  restartButton.addEventListener('click', function () {
    gameOverPopup.style.display = 'none'; // Hide the popup
    resetGame(); // Reset the game state
    game = setInterval(updateGame, 200); // Start the game loop again
    startButton.disabled = true; // Disable the start button
  });

  function resetGame() {
    snake = [{ x: 10 * box, y: 10 * box }];
    direction = 'RIGHT';
    apple = {
      x: Math.floor(Math.random() * 20) * box,
      y: Math.floor(Math.random() * 20) * box,
    };
    currentLetterIndex = 0;
    secretCodeDisplay.innerHTML = ''; // Clear the secret code display
    ctx.clearRect(0, 0, canvas.width, canvas.height);
  }

  function changeDirection(event) {
    event.preventDefault(); // Prevent the default behavior of arrow keys (scrolling)

    if (event.keyCode === 37 && direction !== 'RIGHT') direction = 'LEFT';
    if (event.keyCode === 38 && direction !== 'DOWN') direction = 'UP';
    if (event.keyCode === 39 && direction !== 'LEFT') direction = 'RIGHT';
    if (event.keyCode === 40 && direction !== 'UP') direction = 'DOWN';
  }

  // Add mobile control button functionality
  leftBtn.addEventListener('click', function () {
    if (direction !== 'RIGHT') direction = 'LEFT';
  });
  rightBtn.addEventListener('click', function () {
    if (direction !== 'LEFT') direction = 'RIGHT';
  });
  upBtn.addEventListener('click', function () {
    if (direction !== 'DOWN') direction = 'UP';
  });
  downBtn.addEventListener('click', function () {
    if (direction !== 'UP') direction = 'DOWN';
  });

  function drawSnake() {
    for (let i = 0; i < snake.length; i++) {
      ctx.fillStyle = i === 0 ? 'green' : 'white';
      ctx.fillRect(snake[i].x, snake[i].y, box, box);
      ctx.strokeStyle = 'red';
      ctx.strokeRect(snake[i].x, snake[i].y, box, box);
    }
  }

  function drawApple() {
    ctx.fillStyle = 'red';
    ctx.fillRect(apple.x, apple.y, box, box);
  }

  function updateGame() {
    const snakeX = snake[0].x;
    const snakeY = snake[0].y;

    if (snakeX === apple.x && snakeY === apple.y) {
      apple = {
        x: Math.floor(Math.random() * 20) * box,
        y: Math.floor(Math.random() * 20) * box,
      };

      if (currentLetterIndex < secretCode.length) {
        secretCodeDisplay.innerHTML += secretCode[currentLetterIndex]; // Add letters to the display
        currentLetterIndex++;
      }
    } else {
      snake.pop();
    }

    let newHead = { x: snakeX, y: snakeY };

    if (direction === 'LEFT') newHead.x -= box;
    if (direction === 'UP') newHead.y -= box;
    if (direction === 'RIGHT') newHead.x += box;
    if (direction === 'DOWN') newHead.y += box;

    if (
      newHead.x < 0 ||
      newHead.x >= canvas.width ||
      newHead.y < 0 ||
      newHead.y >= canvas.height ||
      collision(newHead, snake)
    ) {
      clearInterval(game);
      showGameOverPopup(); // Show the Game Over popup
    }

    snake.unshift(newHead);

    ctx.clearRect(0, 0, canvas.width, canvas.height);
    drawApple();
    drawSnake();
  }

  function collision(head, snake) {
    for (let i = 0; i < snake.length; i++) {
      if (head.x === snake[i].x && head.y === snake[i].y) return true;
    }
    return false;
  }

  // Show the Game Over popup
  function showGameOverPopup() {
    gameOverPopup.style.display = 'block';
    startButton.disabled = false; // Re-enable the start button after the game ends
  }

  /********************** Add to Calendar: Welcome Dinner **********************/
  var welcomeDinnerCalendar = createCalendar({
    options: {
      class: 'small-calendar-button',
      id: '',
    },
    data: {
      title: "Ravi and Sam's Welcome Dinner",
      start: new Date('Feb 14, 2025 18:00'),
      end: new Date('Feb 14, 2025 21:00'),
      address: 'Location coming soon',
      description:
        'Join us for a wonderful evening to kick off the celebrations!',
    },
  });

  $('#add-welcome-dinner').html(welcomeDinnerCalendar);

  /********************** Add to Calendar: Ceremony and Reception **********************/
  var ceremonyReceptionCalendar = createCalendar({
    options: {
      class: 'small-calendar-button',
      id: '',
    },
    data: {
      title: "Ravi and Sam's Wedding Ceremony and Reception",
      start: new Date('Feb 15, 2025 17:00'),
      end: new Date('Feb 16, 2025 00:00'),
      address: 'Fandi Mata, 74 Bayard St., Brooklyn, NY 11222',
      description: "We can't wait to see you on our big day.",
    },
  });

  $('#add-ceremony-reception').html(ceremonyReceptionCalendar);

  /********************** RSVP **********************/
  // Initially disable the submit button
  $('.rsvp-btn').prop('disabled', true);

  var hasFocusedName = false;
  var hasFocusedEmail = false;
  var hasFocusedWelcomeDinner = false;
  var hasFocusedCeremonyReception = false;

  // Function to validate all fields
  function validateForm() {
    var name = $('input[name="name"]').val().trim().toLowerCase();
    var email = $('input[name="email"]').val().trim();
    var welcomeDinner = $('input[name="welcome_dinner"]')
      .val()
      .trim()
      .toLowerCase();
    var ceremonyReception = $('input[name="ceremony_reception"]')
      .val()
      .trim()
      .toLowerCase();

    // Email validation regex
    var emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;

    // Clear any previous alerts
    $('#alert-wrapper').html('');

    // Only check the name field if the user has interacted with it
    if (hasFocusedName) {
      if (name) {
        var hashedName = MD5(name); // Use the MD5 function to hash the input name

        // Check if the hashed name is in the guest list
        if (!guestList[hashedName]) {
          // Show a note if the name is not found in the guest list
          $('#alert-wrapper').html(
            alert_markup(
              'warning',
              '<strong>Note:</strong> Your name is not on the guest list. Please check the spelling or contact us.'
            )
          );
          $('.rsvp-btn').prop('disabled', true); // Disable the submit button
          return false; // Stop validation if this check fails
        }
      } else {
        // If the name input is empty, disable the submit button
        $('.rsvp-btn').prop('disabled', true);
        return false;
      }
    }

    // Only check the email field if the user has interacted with it
    if (hasFocusedEmail) {
      if (!emailPattern.test(email)) {
        $('#alert-wrapper').html(
          alert_markup(
            'warning',
            '<strong>Note:</strong> Please enter a valid email address.'
          )
        );
        $('.rsvp-btn').prop('disabled', true); // Disable the submit button
        return false; // Stop validation if this check fails
      }
    }

    // Only check the welcome_dinner field if the user has interacted with it
    if (hasFocusedWelcomeDinner) {
      if (welcomeDinner !== 'yes' && welcomeDinner !== 'no') {
        $('#alert-wrapper').html(
          alert_markup(
            'warning',
            '<strong>Note:</strong> Welcome dinner must be "yes" or "no".'
          )
        );
        $('.rsvp-btn').prop('disabled', true); // Disable the submit button
        return false; // Stop validation if this check fails
      }
    }

    // Only check the ceremony_reception field if the user has interacted with it
    if (hasFocusedCeremonyReception) {
      if (ceremonyReception !== 'yes' && ceremonyReception !== 'no') {
        $('#alert-wrapper').html(
          alert_markup(
            'warning',
            '<strong>Note:</strong> Ceremony reception must be "yes" or "no".'
          )
        );
        $('.rsvp-btn').prop('disabled', true); // Disable the submit button
        return false; // Stop validation if this check fails
      }
    }

    // If all checks pass, enable the submit button
    $('.rsvp-btn').prop('disabled', false);
    return true;
  }

  // Track if the user has focused on name input
  $('input[name="name"]').on('focus', function () {
    hasFocusedName = true;
  });

  // Track if the user has focused on email input
  $('input[name="email"]').on('focus', function () {
    hasFocusedEmail = true;
  });

  // Track if the user has focused on welcome_dinner input
  $('input[name="welcome_dinner"]').on('focus', function () {
    hasFocusedWelcomeDinner = true;
  });

  // Track if the user has focused on ceremony_reception input
  $('input[name="ceremony_reception"]').on('focus', function () {
    hasFocusedCeremonyReception = true;
  });

  // Event listener for when the user finishes typing in any field
  $(
    'input[name="name"], input[name="email"], input[name="welcome_dinner"], input[name="ceremony_reception"]'
  ).on('blur', function () {
    validateForm();
  });

  // Disable form submission if the validation fails at any point
  $('#rsvp-form').on('submit', function (e) {
    if (!validateForm()) {
      e.preventDefault(); // Prevent form submission if validation fails
    }
  });

  // Optional: Event listeners for other fields (email, welcome_dinner, and ceremony_reception) if you want live validation on those as well
  $(
    'input[name="email"], input[name="welcome_dinner"], input[name="ceremony_reception"]'
  ).on('blur', function () {
    // Trigger the name blur event to recheck all fields when any of these fields change
    $('input[name="name"]').trigger('blur');
  });

  $('#rsvp-form').on('submit', function (e) {
    e.preventDefault();
    var formData = $(this).serialize();

    $('#alert-wrapper').html(
      alert_markup(
        'info',
        '<strong>Just a sec!</strong> We are saving your details.'
      )
    );

    // Get the user's name from the form
    var name = $('input[name="name"]').val().trim().toLowerCase();
    var hashedName = MD5(name); // Use the MD5 function to hash the input name

    // Check if the hashed name is in the guest list
    if (guestList[hashedName]) {
      if (guestList[hashedName].plusOneAllowed) {
        // If plus one is allowed, prompt for the plus one name
        var plusOneName = prompt(
          'You are allowed to bring a plus one. Please enter their name or (N/A):'
        );
        if (plusOneName) {
          // Add the plus one name to formData
          formData += '&plus_one=' + encodeURIComponent(plusOneName);
        }
      }

      // Proceed to submit the form data
      $.post(
        'https://script.google.com/macros/s/AKfycbxTz4SsYEpZef68mwSFTEFugtmiDcV7HFbGQC2ANaj5ga_NTasdkZzaXG_XkXZ-HugWkw/exec',
        formData
      )
        .done(function (data) {
          console.log(data);
          if (data.result === 'error') {
            $('#alert-wrapper').html(alert_markup('danger', data.message));
          } else {
            $('#alert-wrapper').html('');
            $('#rsvp-modal').modal('show');
          }
        })
        .fail(function (data) {
          console.log(data);
          $('#alert-wrapper').html(
            alert_markup(
              'danger',
              '<strong>Sorry!</strong> There is some issue with the server. Please email ravi.sam.wedding@gmail.com for assistance.'
            )
          );
        });
    } else {
      // Show an error if the name is not found in the guest list
      $('#alert-wrapper').html(
        alert_markup(
          'danger',
          '<strong>Sorry!</strong> Your name is not on the guest list. Please email ravi.sam.wedding@gmail.com for assistance.'
        )
      );
    }
  });
});
/********************** Extras **********************/

// alert_markup
function alert_markup(alert_type, msg) {
  return (
    '<div class="alert alert-' +
    alert_type +
    '" role="alert">' +
    msg +
    '<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span>&times;</span></button></div>'
  );
}

// MD5 Encoding
var MD5 = function (string) {
  function RotateLeft(lValue, iShiftBits) {
    return (lValue << iShiftBits) | (lValue >>> (32 - iShiftBits));
  }

  function AddUnsigned(lX, lY) {
    var lX4, lY4, lX8, lY8, lResult;
    lX8 = lX & 0x80000000;
    lY8 = lY & 0x80000000;
    lX4 = lX & 0x40000000;
    lY4 = lY & 0x40000000;
    lResult = (lX & 0x3fffffff) + (lY & 0x3fffffff);
    if (lX4 & lY4) {
      return lResult ^ 0x80000000 ^ lX8 ^ lY8;
    }
    if (lX4 | lY4) {
      if (lResult & 0x40000000) {
        return lResult ^ 0xc0000000 ^ lX8 ^ lY8;
      } else {
        return lResult ^ 0x40000000 ^ lX8 ^ lY8;
      }
    } else {
      return lResult ^ lX8 ^ lY8;
    }
  }

  function F(x, y, z) {
    return (x & y) | (~x & z);
  }

  function G(x, y, z) {
    return (x & z) | (y & ~z);
  }

  function H(x, y, z) {
    return x ^ y ^ z;
  }

  function I(x, y, z) {
    return y ^ (x | ~z);
  }

  function FF(a, b, c, d, x, s, ac) {
    a = AddUnsigned(a, AddUnsigned(AddUnsigned(F(b, c, d), x), ac));
    return AddUnsigned(RotateLeft(a, s), b);
  }

  function GG(a, b, c, d, x, s, ac) {
    a = AddUnsigned(a, AddUnsigned(AddUnsigned(G(b, c, d), x), ac));
    return AddUnsigned(RotateLeft(a, s), b);
  }

  function HH(a, b, c, d, x, s, ac) {
    a = AddUnsigned(a, AddUnsigned(AddUnsigned(H(b, c, d), x), ac));
    return AddUnsigned(RotateLeft(a, s), b);
  }

  function II(a, b, c, d, x, s, ac) {
    a = AddUnsigned(a, AddUnsigned(AddUnsigned(I(b, c, d), x), ac));
    return AddUnsigned(RotateLeft(a, s), b);
  }

  function ConvertToWordArray(string) {
    var lWordCount;
    var lMessageLength = string.length;
    var lNumberOfWords_temp1 = lMessageLength + 8;
    var lNumberOfWords_temp2 =
      (lNumberOfWords_temp1 - (lNumberOfWords_temp1 % 64)) / 64;
    var lNumberOfWords = (lNumberOfWords_temp2 + 1) * 16;
    var lWordArray = Array(lNumberOfWords - 1);
    var lBytePosition = 0;
    var lByteCount = 0;
    while (lByteCount < lMessageLength) {
      lWordCount = (lByteCount - (lByteCount % 4)) / 4;
      lBytePosition = (lByteCount % 4) * 8;
      lWordArray[lWordCount] =
        lWordArray[lWordCount] |
        (string.charCodeAt(lByteCount) << lBytePosition);
      lByteCount++;
    }
    lWordCount = (lByteCount - (lByteCount % 4)) / 4;
    lBytePosition = (lByteCount % 4) * 8;
    lWordArray[lWordCount] = lWordArray[lWordCount] | (0x80 << lBytePosition);
    lWordArray[lNumberOfWords - 2] = lMessageLength << 3;
    lWordArray[lNumberOfWords - 1] = lMessageLength >>> 29;
    return lWordArray;
  }

  function WordToHex(lValue) {
    var WordToHexValue = '',
      WordToHexValue_temp = '',
      lByte,
      lCount;
    for (lCount = 0; lCount <= 3; lCount++) {
      lByte = (lValue >>> (lCount * 8)) & 255;
      WordToHexValue_temp = '0' + lByte.toString(16);
      WordToHexValue =
        WordToHexValue +
        WordToHexValue_temp.substr(WordToHexValue_temp.length - 2, 2);
    }
    return WordToHexValue;
  }

  function Utf8Encode(string) {
    string = string.replace(/\r\n/g, '\n');
    var utftext = '';

    for (var n = 0; n < string.length; n++) {
      var c = string.charCodeAt(n);

      if (c < 128) {
        utftext += String.fromCharCode(c);
      } else if (c > 127 && c < 2048) {
        utftext += String.fromCharCode((c >> 6) | 192);
        utftext += String.fromCharCode((c & 63) | 128);
      } else {
        utftext += String.fromCharCode((c >> 12) | 224);
        utftext += String.fromCharCode(((c >> 6) & 63) | 128);
        utftext += String.fromCharCode((c & 63) | 128);
      }
    }

    return utftext;
  }

  var x = Array();
  var k, AA, BB, CC, DD, a, b, c, d;
  var S11 = 7,
    S12 = 12,
    S13 = 17,
    S14 = 22;
  var S21 = 5,
    S22 = 9,
    S23 = 14,
    S24 = 20;
  var S31 = 4,
    S32 = 11,
    S33 = 16,
    S34 = 23;
  var S41 = 6,
    S42 = 10,
    S43 = 15,
    S44 = 21;

  string = Utf8Encode(string);

  x = ConvertToWordArray(string);

  a = 0x67452301;
  b = 0xefcdab89;
  c = 0x98badcfe;
  d = 0x10325476;

  for (k = 0; k < x.length; k += 16) {
    AA = a;
    BB = b;
    CC = c;
    DD = d;
    a = FF(a, b, c, d, x[k + 0], S11, 0xd76aa478);
    d = FF(d, a, b, c, x[k + 1], S12, 0xe8c7b756);
    c = FF(c, d, a, b, x[k + 2], S13, 0x242070db);
    b = FF(b, c, d, a, x[k + 3], S14, 0xc1bdceee);
    a = FF(a, b, c, d, x[k + 4], S11, 0xf57c0faf);
    d = FF(d, a, b, c, x[k + 5], S12, 0x4787c62a);
    c = FF(c, d, a, b, x[k + 6], S13, 0xa8304613);
    b = FF(b, c, d, a, x[k + 7], S14, 0xfd469501);
    a = FF(a, b, c, d, x[k + 8], S11, 0x698098d8);
    d = FF(d, a, b, c, x[k + 9], S12, 0x8b44f7af);
    c = FF(c, d, a, b, x[k + 10], S13, 0xffff5bb1);
    b = FF(b, c, d, a, x[k + 11], S14, 0x895cd7be);
    a = FF(a, b, c, d, x[k + 12], S11, 0x6b901122);
    d = FF(d, a, b, c, x[k + 13], S12, 0xfd987193);
    c = FF(c, d, a, b, x[k + 14], S13, 0xa679438e);
    b = FF(b, c, d, a, x[k + 15], S14, 0x49b40821);
    a = GG(a, b, c, d, x[k + 1], S21, 0xf61e2562);
    d = GG(d, a, b, c, x[k + 6], S22, 0xc040b340);
    c = GG(c, d, a, b, x[k + 11], S23, 0x265e5a51);
    b = GG(b, c, d, a, x[k + 0], S24, 0xe9b6c7aa);
    a = GG(a, b, c, d, x[k + 5], S21, 0xd62f105d);
    d = GG(d, a, b, c, x[k + 10], S22, 0x2441453);
    c = GG(c, d, a, b, x[k + 15], S23, 0xd8a1e681);
    b = GG(b, c, d, a, x[k + 4], S24, 0xe7d3fbc8);
    a = GG(a, b, c, d, x[k + 9], S21, 0x21e1cde6);
    d = GG(d, a, b, c, x[k + 14], S22, 0xc33707d6);
    c = GG(c, d, a, b, x[k + 3], S23, 0xf4d50d87);
    b = GG(b, c, d, a, x[k + 8], S24, 0x455a14ed);
    a = GG(a, b, c, d, x[k + 13], S21, 0xa9e3e905);
    d = GG(d, a, b, c, x[k + 2], S22, 0xfcefa3f8);
    c = GG(c, d, a, b, x[k + 7], S23, 0x676f02d9);
    b = GG(b, c, d, a, x[k + 12], S24, 0x8d2a4c8a);
    a = HH(a, b, c, d, x[k + 5], S31, 0xfffa3942);
    d = HH(d, a, b, c, x[k + 8], S32, 0x8771f681);
    c = HH(c, d, a, b, x[k + 11], S33, 0x6d9d6122);
    b = HH(b, c, d, a, x[k + 14], S34, 0xfde5380c);
    a = HH(a, b, c, d, x[k + 1], S31, 0xa4beea44);
    d = HH(d, a, b, c, x[k + 4], S32, 0x4bdecfa9);
    c = HH(c, d, a, b, x[k + 7], S33, 0xf6bb4b60);
    b = HH(b, c, d, a, x[k + 10], S34, 0xbebfbc70);
    a = HH(a, b, c, d, x[k + 13], S31, 0x289b7ec6);
    d = HH(d, a, b, c, x[k + 0], S32, 0xeaa127fa);
    c = HH(c, d, a, b, x[k + 3], S33, 0xd4ef3085);
    b = HH(b, c, d, a, x[k + 6], S34, 0x4881d05);
    a = HH(a, b, c, d, x[k + 9], S31, 0xd9d4d039);
    d = HH(d, a, b, c, x[k + 12], S32, 0xe6db99e5);
    c = HH(c, d, a, b, x[k + 15], S33, 0x1fa27cf8);
    b = HH(b, c, d, a, x[k + 2], S34, 0xc4ac5665);
    a = II(a, b, c, d, x[k + 0], S41, 0xf4292244);
    d = II(d, a, b, c, x[k + 7], S42, 0x432aff97);
    c = II(c, d, a, b, x[k + 14], S43, 0xab9423a7);
    b = II(b, c, d, a, x[k + 5], S44, 0xfc93a039);
    a = II(a, b, c, d, x[k + 12], S41, 0x655b59c3);
    d = II(d, a, b, c, x[k + 3], S42, 0x8f0ccc92);
    c = II(c, d, a, b, x[k + 10], S43, 0xffeff47d);
    b = II(b, c, d, a, x[k + 1], S44, 0x85845dd1);
    a = II(a, b, c, d, x[k + 8], S41, 0x6fa87e4f);
    d = II(d, a, b, c, x[k + 15], S42, 0xfe2ce6e0);
    c = II(c, d, a, b, x[k + 6], S43, 0xa3014314);
    b = II(b, c, d, a, x[k + 13], S44, 0x4e0811a1);
    a = II(a, b, c, d, x[k + 4], S41, 0xf7537e82);
    d = II(d, a, b, c, x[k + 11], S42, 0xbd3af235);
    c = II(c, d, a, b, x[k + 2], S43, 0x2ad7d2bb);
    b = II(b, c, d, a, x[k + 9], S44, 0xeb86d391);
    a = AddUnsigned(a, AA);
    b = AddUnsigned(b, BB);
    c = AddUnsigned(c, CC);
    d = AddUnsigned(d, DD);
  }

  var temp = WordToHex(a) + WordToHex(b) + WordToHex(c) + WordToHex(d);

  return temp.toLowerCase();
};
